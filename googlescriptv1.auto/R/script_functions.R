#' Google Apps Script Execution API
#' Executes Google Apps Script projects.
#' 
#' Auto-generated code by googleAuthR::gar_create_api_skeleton
#'  at 2016-09-03 23:22:54
#' filename: /Users/mark/dev/R/autoGoogleAPI/googlescriptv1.auto/R/script_functions.R
#' api_json: api_json
#' 
#' @details 
#' Authentication scopes used are:
#' \itemize{
#'   \item https://mail.google.com/
#' \item https://www.google.com/calendar/feeds
#' \item https://www.google.com/m8/feeds
#' \item https://www.googleapis.com/auth/admin.directory.group
#' \item https://www.googleapis.com/auth/admin.directory.user
#' \item https://www.googleapis.com/auth/drive
#' \item https://www.googleapis.com/auth/forms
#' \item https://www.googleapis.com/auth/forms.currentonly
#' \item https://www.googleapis.com/auth/groups
#' \item https://www.googleapis.com/auth/spreadsheets
#' \item https://www.googleapis.com/auth/userinfo.email
#' }
#' 
#' @docType package 
#' @name script_googleAuthR
#' 
NULL
## NULL



#' Runs a function in an Apps Script project that has been deployed for use with the Apps Script Execution API. This method requires authorization with an OAuth 2.0 token that includes at least one of the scopes listed in the [Authentication](#authentication) section; script projects that do not require authorization cannot be executed through this API. To find the correct scopes to include in the authentication token, open the project in the script editor, then select **File > Project properties** and click the **Scopes** tab.
#' 
#' Autogenerated via \code{\link[googleAuthR]{gar_create_api_skeleton}}
#' 
#' @seealso \href{https://developers.google.com/apps-script/execution/rest/v1/scripts/run}{Google Documentation}
#' 
#' @details 
#' Authentication scopes used by this function are:
#' \itemize{
#'   \item https://mail.google.com/
#' \item https://www.google.com/calendar/feeds
#' \item https://www.google.com/m8/feeds
#' \item https://www.googleapis.com/auth/admin.directory.group
#' \item https://www.googleapis.com/auth/admin.directory.user
#' \item https://www.googleapis.com/auth/drive
#' \item https://www.googleapis.com/auth/forms
#' \item https://www.googleapis.com/auth/forms.currentonly
#' \item https://www.googleapis.com/auth/groups
#' \item https://www.googleapis.com/auth/spreadsheets
#' \item https://www.googleapis.com/auth/userinfo.email
#' }
#' 
#' Set \code{options(googleAuthR.scopes.selected = c(https://mail.google.com/, https://www.google.com/calendar/feeds, https://www.google.com/m8/feeds, https://www.googleapis.com/auth/admin.directory.group, https://www.googleapis.com/auth/admin.directory.user, https://www.googleapis.com/auth/drive, https://www.googleapis.com/auth/forms, https://www.googleapis.com/auth/forms.currentonly, https://www.googleapis.com/auth/groups, https://www.googleapis.com/auth/spreadsheets, https://www.googleapis.com/auth/userinfo.email)}
#' Then run \code{googleAuthR::gar_auth()} to authenticate.
#' See \code{\link[googleAuthR]{gar_auth}} for details. 
#' 
#' @param ExecutionRequest The \link{ExecutionRequest} object to pass to this method
#' @param scriptId The project key of the script to be executed
#' @importFrom googleAuthR gar_api_generator
#' @family ExecutionRequest functions
#' @export


.run <- function(ExecutionRequest, scriptId) {
    
    
    url <- sprintf("https://script.googleapis.com/v1/scripts/%s:run", scriptId)
    # script.scripts.run
    f <- gar_api_generator(url, "POST", data_parse_function = function(x) x)
    
    stopifnot(inherits(ExecutionRequest, "gar_ExecutionRequest"))
    
    f(the_body = ExecutionRequest)
    
    
}



